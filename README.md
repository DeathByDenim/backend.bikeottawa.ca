# backend.bikeottawa.ca
Set of scripts to generate and sync data files for maps.bikeottawa.ca

## Installation
Prerequisites: NodeJS, Python
``` 
git clone https://github.com/BikeOttawa/backend.bikeottawa.ca
cd backend.bikeottawa.ca/
npm install
pip install --user mapboxcli
```

You also need the rmoc.osm file and the LTS json files. These can be obtained using the LTSAnalyzer which is in the stressmodel repo at https://github.com/BikeOttawa/stressmodel

The command for generating the json files compatible with the build scripts in this repo is
```
node main.js -f update/rmoc.osm -d levelfiles -p level_ -z
```
## Running
```
./build.sh >> build.log
```
**build.sh** script does the following:
- copies OSM extract and LTS json files generated by LTSAnalyzer into working folder
- uploads LTS json files to Mapbox to use as tilesets
- generates 4 separate OSM extracts (one for each LTS) based on LTS json files
- builds OSRM routing data files for each LTS 
- syncs generated OSRM data to maps.bikeottawa.ca


## Tilesets

- 0lwwjb4e - winter - 2,505 km
- 1bli4ynb - pathways - 1,979 km
- 6e5700mn  - amenities - 1,689 km
- 4hnbbuhd - desire - 468 km
- 0ne8pnv3 - lts4 - 5,583 km
- 7gev94ax - lts1 - 2,876 km
- 42dlr9v2 - lts3 - 5,592 km
- 2p4cgvm3 - lts2 - 7,158 km
- 6wnvt0cx - pathways(unused duplicate?) - 1,395 km
